dist: xenial
sudo: required

language: node_js
node_js:
- "8.11.3"

before_install:
- sudo add-apt-repository -y ppa:ubuntu-toolchain-r/test
- sudo apt-get update -qq

install:
- sudo apt-get install -qq g++-8
- sudo update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-8 90
- git clone https://github.com/devosoft/Empirical ../Empirical
- git clone https://github.com/emscripten-core/emsdk.git && cd emsdk && git pull && ./emsdk install latest && ./emsdk activate latest && . ./emsdk_env.sh && cd ..

script:
- make test

after_success:
- git config --global user.email "travis@travis-ci.org"
- git config --global user.name "Travis CI"
- cd web
- git init
- git remote add origin https://${GH_TOKEN}@github.com/devosoft/evoke.git > /dev/null 2>&1
- git checkout -b gh-pages
- git add .
- git commit --message "Travis build ${TRAVIS_BUILD_NUMBER}"
- test ${TRAVIS_BRANCH} = "master" && git push --force --quiet origin gh-pages

env:
  global:
    secure: X6U3RpnOjgJqNe7gF0hVFye+uVKhtaKLreDMD3M/EnG0SRkCYyymf2eKR14dhrDJzGKkKsv8psPYPljrM32ofLFtvP60CbD6h0duIQugJNSspO4klKkpgwdE//lk89KMJ/QtcQyZ5c2KXYTJ2fxuJD0Vnp1Vnqu9GahNChKEk6px8sdtQYuodfVs8TWb9zJczkCBa7tCNOuWz95ptP25UbTWINTPS4L4k9MUNjixISi0otoxa1jD17oiKNyUonnHZ2JzwDlaasqcnhTb2hJJvoRMQR220xnwlD9OOejvOmJUMPZJ/H/nitYufcnEGI7kE5HGSdpGZdVAirewM+KmnKCUQLEbUR03Llzr+19hGY0NA8nL1yk9RjJZ3O0xJ3Cdg88/4a1BQpzhTAyT/BaHcyvKl05h3iZUXj21FhCLXRjuURuV07G3S5XLQ180ZCR2bKhhmuLDg9oVcN2Z52y5o3sI8nhJ3hfdF3sdnYpRx0yxfFkbeVrvti7DLU2yTyM3AjxYP0EsCm53SKtsEG7GLUYTA2H2wmjjcJqaR64VGORcxXjpKi7BU8KK0r39RC0tZ5HwJICXJpLxthQ0N5F+mTPDpLO0+XTz8GHcKQs2Y99Lg91yTF4K7OnPPFKmqo4cmFnm5g7iJ9ZgRluC9pUzIHjOkL1KlYOZxmd0N6ErUDo=
